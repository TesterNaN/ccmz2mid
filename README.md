# 🎵 ccmz2mid - 虫虫钢琴 CCMZ 格式转换器

[![License: GPLv3](https://img.shields.io/badge/License-GPL%20v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
![Python](https://img.shields.io/badge/Python-3.6+-green.svg)
![Platform](https://img.shields.io/badge/Platform-全平台-lightgrey)
![Web Version](https://img.shields.io/badge/网页版-在线转换-brightgreen)

> **专为虫虫钢琴(gangqinpu.com)设计的 CCMZ 加密格式转换工具**  
> 将虫虫钢琴私有加密格式转换为标准 MIDI 文件

## 🌟 项目亮点

- 🔓 **完美解密**：支持虫虫钢琴 CCMZ v1/v2 双版本加密格式
- 🎵 **高保真转换**：完整保留速度、拍号、力度等所有音乐信息
- 🌐 **多平台支持**：提供桌面版、网页版、浏览器扩展三种使用方式
- 🚀 **一键转换**：支持在线下载、本地转换、浏览器一键操作

## 📋 目录

- [🎯 功能特点](#-功能特点)
- [🌈 三种使用方式](#-三种使用方式)
  - [🖥️ 桌面版](#️-桌面版)
  - [🌐 网页版](#-网页版)
  - [🐵 油猴脚本](#-油猴脚本)
- [🛠️ 安装与使用](#️-安装与使用)
- [📖 使用教程](#-使用教程)
- [🤝 贡献指南](#-贡献指南)
- [📄 许可证](#-许可证)
- [⚠️ 免责声明](#️-免责声明)

## 🎯 功能特点

### 核心功能
- ✅ **CCMZ 解密**：支持虫虫钢琴 v1/v2 加密格式
- ✅ **midi.json 解析**：精确解析虫虫钢琴 MIDI 数据结构
- ✅ **标准 MIDI 输出**：生成兼容所有播放器的 MIDI 文件
- ✅ **多平台支持**：桌面、网页、浏览器插件全覆盖

### 支持的音乐元素
- 🎹 **音符事件**：Note On/Off，完整力度信息
- 🎚️ **控制信息**：音色变化、控制变化、弯音轮
- 🎼 **时间信息**：速度变化、拍号变化、小节划分
- 🎛️ **多轨道**：保持原始轨道分离和通道分配

## 🌈 三种使用方式

### 🖥️ 桌面版
**适合**：批量处理、离线使用、自动化脚本  
**特点**：功能最完整，支持批量转换和复杂操作  
[前往安装](#️-安装与使用)

### 🌐 网页版
**适合**：快速转换、临时使用、移动设备  
**特点**：无需安装，即开即用，支持拖放上传  
🌐 **访问地址**：[https://testernan.github.io/ccmz2mid/](https://testernan.github.io/ccmz2mid/)

**网页版功能**：
- 📁 **拖放上传**：直接将 CCMZ 文件拖到页面即可
- 🔗 **URL 转换**：粘贴 CCMZ 链接在线转换
- 📱 **响应式设计**：手机、平板、电脑都可用
- 🚫 **无需安装**：完全在浏览器中运行

### 🐵 油猴脚本
**适合**：虫虫钢琴用户，一键下载转换  
**特点**：无缝集成到虫虫钢琴网站，联动网页版一键转换  
📦 **脚本地址**：[Greasy Fork](https://greasyfork.org/zh-CN/scripts/457019-虫虫钢琴铺面查看脚本)

**脚本功能**：
- 🚀 **一键转换**：在虫虫钢琴页面直接添加转换按钮
- 🔗 **自动获取**：自动提取页面中的 CCMZ 链接
- 🌐 **联动网页版**：自动跳转到网页版完成转换
- 🎯 **智能识别**：支持乐谱详情页、收藏页面等

## 🛠️ 安装与使用

### 环境要求
- Python 3.6 或更高版本
- 网络连接（用于下载功能）

### 安装方法

#### 1. 下载项目
```bash
# 克隆项目
git clone https://github.com/TesterNaN/ccmz2mid.git
cd ccmz2mid
```

#### 2. 安装依赖
```bash
# 安装必需的 mido 库
pip install mido
```

#### 3. 运行程序
```bash
python ccmz2mid.py
```

## 📖 使用教程

### 🖥️ 桌面版使用方法

启动程序：
```bash
python ccmz2mid.py
```

程序启动后将显示如下界面：
```
============================
🎵 CCMZ 到 MIDI 转换工具
============================

请选择操作:
1. 从 URL 下载并转换 CCMZ 文件
2. 转换本地 CCMZ 文件
3. 使用示例 URL 测试
4. 退出
----------------------------------------
请选择 (1-4):
```

### 🌐 网页版使用方法

1. **打开网页**：[https://testernan.github.io/ccmz2mid/](https://testernan.github.io/ccmz2mid/)
2. **选择转换方式**：
   - 拖放 CCMZ 文件到页面
   - 或粘贴 CCMZ 文件 URL
3. **等待转换**：自动完成解密和转换
4. **下载 MIDI**：点击下载按钮保存 MIDI 文件

### 🐵 油猴脚本使用方法

1. **安装脚本**：访问 [Greasy Fork页面](https://greasyfork.org/zh-CN/scripts/457019-虫虫钢琴铺面查看脚本) 安装脚本
2. **访问虫虫钢琴**：浏览你想要的乐谱
3. **点击按钮**：在乐谱页面找到"解析MIDI"按钮
4. **自动跳转**：选择"网页版转换"，自动跳转到网页版完成转换

### 转换流程对比

| 方式 | 优点 | 适用场景 |
|------|------|----------|
| **桌面版** | 功能完整，支持批量，离线可用 | 批量处理，专业用户，自动化 |
| **网页版** | 无需安装，跨平台，简单易用 | 快速转换，临时使用，移动设备 |
| **油猴脚本** | 最便捷，无缝集成，一键操作 | 经常使用虫虫钢琴的用户 |

## 🤝 贡献指南

### 如何贡献
1. **Fork 本仓库**
2. **创建特性分支**
   ```bash
   git checkout -b feature/amazing-feature
   ```
3. **提交更改**
   ```bash
   git commit -m '添加了很棒的功能'
   ```
4. **推送到分支**
   ```bash
   git push origin feature/amazing-feature
   ```
5. **开启 Pull Request**

### 开发环境设置
```bash
# 1. 克隆仓库
git clone https://github.com/TesterNaN/ccmz2mid.git
cd ccmz2mid

# 2. 创建虚拟环境（可选）
python -m venv venv
source venv/bin/activate  # Linux/macOS
venv\Scripts\activate     # Windows

# 3. 安装依赖
pip install mido
```

### 项目结构
```
ccmz2mid/
├── ccmz2mid.py          # 桌面版主程序
├── web/                 # 网页版源代码
│   ├── index.html      # 网页版主页面
│   ├── js/             # JavaScript 代码
│   └── css/            # 样式文件
├── tampermonkey/        # 油猴脚本代码
├── examples/            # 示例文件
└── README.md           # 说明文档
```

## 📄 许可证

本项目采用 **GNU General Public License v3.0** 开源许可证。

## ⚠️ 免责声明

### 合法使用
1. **版权尊重**：本工具仅用于**个人学习、研究和备份**目的
2. **禁止商用**：请勿将转换后的 MIDI 文件用于商业用途
3. **遵守条款**：使用前请阅读虫虫钢琴网站的服务条款

### 责任声明
- 本工具为开源项目，作者不承担任何使用后果
- 请确保你有权转换相关乐谱文件
- 支持正版音乐，尊重创作者权益

### 项目初衷
本项目的目标是：
- 🔓 **技术研究**：研究音乐文件格式转换技术
- 💾 **数据备份**：帮助用户备份个人收藏的乐谱
- 🎵 **格式开放**：推动音乐格式的开放和互操作性
- 🌐 **用户体验**：提供多种便捷的使用方式

---

## 📞 联系与支持

### 问题反馈
- 🐛 **Bug 报告**：[GitHub Issues](https://github.com/TesterNaN/ccmz2mid/issues)
- 💡 **功能建议**：通过 Issue 提交
- ❓ **使用问题**：查看常见问题或提交 Issue

### 星标支持
如果这个项目对你有帮助，请点个 ⭐ Star 支持！

---

*感谢虫虫钢琴(gangqinpu.com)为广大音乐爱好者提供的优质乐谱资源！*
